(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34770,        985]
NotebookOptionsPosition[     32954,        921]
NotebookOutlinePosition[     33332,        937]
CellTagsIndexPosition[     33289,        934]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:0418\:043c\:043f\:043e\:0440\:0442 \:0431\:0438\:0431\:043b\:0438\
\:043e\:0442\:0435\:043a", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$FrontEnd", " ", "=!=", " ", "Null"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"$Path", ",", " ", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "#"}], "}"}], 
          "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<../../lib/mathematica\>\"", ",", "\"\<../lib\>\""}], 
       "}"}]}]}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Once", "@", 
      RowBox[{"Get", "[", "#", "]"}]}], " ", "&"}], ")"}], " ", "/@", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "\"\<Formal.m\>\"", ",", " ", "\"\<Features.m\>\"", ",", " ", 
     "\"\<Ricci_grav.m\>\"", ",", " ", "\"\<aux-2-grav-generic.m\>\""}], " ", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747834896265631*^9, 3.747834896883977*^9}, {
   3.747835135758011*^9, 3.747835141530594*^9}, {3.7478351761180515`*^9, 
   3.747835178024971*^9}, {3.7479388915833783`*^9, 3.7479389263813295`*^9}, 
   3.749050853474002*^9, {3.7490508906690044`*^9, 3.749050946644009*^9}}],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"Div\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Div\\\", \
\\\"[\\\", \\\"V_\\\", \\\"]\\\"}]\\) is Protected.\"",2,2,1,
   26804772701765680889,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7491052739875383`*^9, 3.749148198425813*^9, 
  3.749720935926502*^9, 3.749740882072651*^9, 3.7498272583757343`*^9, 
  3.7498277735422754`*^9, 3.7502573487607727`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EnableFeature", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Formatter", "[", "DD", "]"}], ",", 
     RowBox[{"Formatter", "[", "Tensor", "]"}]}], "}"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747909805711826*^9, 3.747909819010262*^9}, {
  3.747909899165156*^9, 3.7479099031016283`*^9}, {3.7479337056662006`*^9, 
  3.747933715780153*^9}, {3.7479340876277003`*^9, 3.7479340895735235`*^9}, {
  3.7479346624215193`*^9, 3.747934665928122*^9}, {3.7479387346799984`*^9, 
  3.747938741635394*^9}, {3.7479387923218184`*^9, 3.7479387945638227`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0412\:0441\:043f\:043e\:043c\:043e\:0433\:0430\:0442\:0435\:043b\:044c\
\:043d\:044b\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:0438", "Section",
 CellChangeTimes->{{3.7478349136052523`*^9, 3.7478349166381507`*^9}}],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 \:043c\:0435\:0442\:0440\
\:0438\:043a\:0438 \:043f\:0440\:043e\:0441\:0442\:0440\:0430\:043d\:0441\
\:0442\:0432\:0430", "Subsection",
 CellChangeTimes->{{3.748458812567663*^9, 3.748458827162644*^9}, {
  3.7485997583119817`*^9, 3.748599765810215*^9}, {3.748600074319586*^9, 
  3.748600080552472*^9}, {3.749050959531637*^9, 3.7490509615310535`*^9}, {
  3.7490511423366303`*^9, 3.7490511527328877`*^9}}],

Cell[BoxData[
 RowBox[{"Spher", ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RecalculateGrav", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.749050999422022*^9, 3.749051001984022*^9}, 
   3.749749249802664*^9, 3.7502565512415075`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 \:0434\:043e\:0431\:0430\
\:0432\:043e\:0447\:043d\:043e\:0439 \:043c\:0435\:0442\:0440\:0438\:043a\
\:0438", "Subsection",
 CellChangeTimes->{{3.748458812567663*^9, 3.748458827162644*^9}, {
  3.7485997583119817`*^9, 3.748599765810215*^9}, {3.748600074319586*^9, 
  3.748600080552472*^9}, {3.749050959531637*^9, 3.7490509615310535`*^9}, {
  3.749051047175002*^9, 3.749051064014742*^9}, {3.7491053086974497`*^9, 
  3.749105315258377*^9}, {3.7502566593475275`*^9, 3.750256706105545*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"thamask", "[", "Even", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thamask", "[", "Odd", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thamask", "[", "All", "]"}], "=", 
   RowBox[{
    RowBox[{"thamask", "[", "Even", "]"}], "+", 
    RowBox[{"thamask", "[", "Odd", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.750257202842784*^9, 3.7502572482743473`*^9}, {
  3.750257475130967*^9, 3.750257484882905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tha", "=", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<f\>\"", ",", 
               RowBox[{"ToString", "@", 
                RowBox[{"First", "@", "#1"}]}], ",", 
               RowBox[{"ToString", "@", 
                RowBox[{"Last", "@", "#1"}]}]}], "]"}], "]"}], "[", "r", 
            "]"}], "#2"}]}], ")"}], "&"}], ",", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "Even", "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "Odd", "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "2", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "2", ",", 
            RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], "]"}], "|>"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Omega]", " ", "ct"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.74972319761199*^9, 3.749723288945554*^9}, {
  3.7502568519597054`*^9, 3.7502568735669265`*^9}, {3.750321010240213*^9, 
  3.750321015750369*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thametr", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "r"}], ",", "1", ",", 
       RowBox[{"Sin", "[", "u", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "r", " ", ",", 
       RowBox[{"r", " ", 
        RowBox[{"Sin", "[", "u", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], ",", 
       RowBox[{"r", " ", 
        RowBox[{"Sin", "[", "u", "]"}]}], ",", 
       RowBox[{"r", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "u", "]"}], "2"]}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7502573726379285`*^9, 3.7502573735505114`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeTensor", "[", "th_Association", "]"}], ":=", 
   RowBox[{"thametr", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
        RowBox[{
         RowBox[{"th", "[", 
          RowBox[{"{", "Even", "}"}], "]"}], "+", 
         RowBox[{"th", "[", 
          RowBox[{"{", "Odd", "}"}], "]"}]}], ",", 
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "]"}], ",", 
        RowBox[{"th", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "]"}], ",", 
        RowBox[{
         RowBox[{"th", "[", 
          RowBox[{"{", "Even", "}"}], "]"}], "-", 
         RowBox[{"th", "[", 
          RowBox[{"{", "Odd", "}"}], "]"}]}]}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.749723435136954*^9, {3.749723480188596*^9, 3.749723481453937*^9}, 
   3.7502568658665094`*^9, 3.750257380282494*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Val", "[", "a_", "]"}], "[", 
    RowBox[{"th", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Val", "[", "a", "]"}], "[", "th", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7502567189282694`*^9, 3.7502567541123333`*^9}, {
  3.750256817287421*^9, 3.750256817531707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Val", "[", "a_", "]"}], "[", "th", "]"}], ":=", 
   RowBox[{
    RowBox[{"MakeTensor", "[", "tha", "]"}], " ", 
    RowBox[{"thamask", "[", "a", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750256804665098*^9, 3.75025701096766*^9}, {
  3.7502570729031076`*^9, 3.7502570743512373`*^9}, {3.750257172460018*^9, 
  3.75025717277419*^9}, {3.750257256731763*^9, 3.7502572713377037`*^9}, {
  3.7502573211725264`*^9, 3.750257334038104*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\:041f\:043e\:043b\:0443\:0447\:0435\:043d\:0438\:0435 \:0434\:0438\
\:0444\:0444\:0435\:0440\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:044b\
\:0445 \:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", "Subsection",
 CellChangeTimes->{{3.748458812567663*^9, 3.748458827162644*^9}, {
  3.7485997583119817`*^9, 3.748599765810215*^9}, {3.748600074319586*^9, 
  3.748600080552472*^9}, {3.749050959531637*^9, 3.7490509615310535`*^9}, {
  3.749051047175002*^9, 3.749051064014742*^9}, {3.7491053086974497`*^9, 
  3.749105315258377*^9}, {3.7502566593475275`*^9, 3.750256706105545*^9}, {
  3.7502574178540864`*^9, 3.750257421111387*^9}, {3.7503479676582365`*^9, 
  3.7503479750131783`*^9}}],

Cell["\:0412\:044b\:0447\:0438\:0441\:043b\:0438\:043c \:0432\:0430\:0440\
\:0438\:0430\:0446\:0438\:0438 \:0434\:043b\:044f \:043d\:0435\:0447\:0435\
\:0442\:043d\:044b\:0445 \:043c\:043e\:0434.", "Text",
 CellChangeTimes->{{3.750257830517086*^9, 3.750257843884256*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{
    RowBox[{"EvaluateAt", "[", 
     RowBox[{"lagr2nvare", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", ":", 
         RowBox[{"th", "[", "a__", "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Val", "[", "Odd", "]"}], "[", "x", "]"}]}], "}"}]}], "]"}], 
    "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"vars", ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.75025742721704*^9, 3.7502575346049957`*^9}, {
  3.7502576073306284`*^9, 3.7502576139615993`*^9}, {3.750257762816946*^9, 
  3.7502577845518494`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", "0", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"]}]], 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", "u", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"f13", "[", "r", "]"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"3", " ", "l"}], "+", 
                SuperscriptBox["l", "2"], "-", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "l", "+", 
                   SuperscriptBox["l", "2"], "+", 
                   RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}], " ", 
              RowBox[{"LegendreP", "[", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"3", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}], " ", 
                 RowBox[{"Cos", "[", "u", "]"}], " ", 
                 RowBox[{"LegendreP", "[", 
                  RowBox[{
                   RowBox[{"1", "+", "l"}], ",", "1", ",", 
                   RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "l"}], ")"}], " ", 
                 RowBox[{"LegendreP", "[", 
                  RowBox[{
                   RowBox[{"2", "+", "l"}], ",", "1", ",", 
                   RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "u", "]"}], " ", 
              RowBox[{"LegendreP", "[", 
               RowBox[{"l", ",", "2", ",", 
                RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], "-", 
             RowBox[{"LegendreP", "[", 
              RowBox[{
               RowBox[{"1", "+", "l"}], ",", "2", ",", 
               RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", "u", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f23", "[", "r", "]"}], "-", 
             RowBox[{"r", " ", 
              RowBox[{
               SuperscriptBox["f23", "\[Prime]",
                MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}], 
         ")"}]}]}]}]},
    {"0", "0", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["r", "2"]], 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", 
           SuperscriptBox["\[Omega]", "2"], " ", 
           RowBox[{"f23", "[", "r", "]"}], " ", 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", "2", ",", 
             RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"2", "+", "l"}], ")"}]}], " ", 
              RowBox[{"Cot", "[", "u", "]"}], " ", 
              RowBox[{"LegendreP", "[", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}], "+", 
             RowBox[{"l", " ", 
              RowBox[{"Csc", "[", "u", "]"}], " ", 
              RowBox[{"LegendreP", "[", 
               RowBox[{
                RowBox[{"1", "+", "l"}], ",", "1", ",", 
                RowBox[{"Cos", "[", "u", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["f13", "\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}], "-", 
          RowBox[{"r", " ", 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", "2", ",", 
             RowBox[{"Cos", "[", "u", "]"}]}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["f23", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}]}]},
    {"0", "0", "0"}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.7502575531405644`*^9, {3.7502576143181744`*^9, 3.7502576158278656`*^9}, 
   3.750257785960085*^9, {3.7503209694261084`*^9, 3.750321019977642*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vars", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"vars", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750257725148632*^9, 3.7502577534889145`*^9}, {
  3.7502577922632627`*^9, 3.7502577961089916`*^9}}],

Cell["\<\
\:041f\:043e\:043b\:0443\:0447\:0438\:043c \:0434\:0438\:0444\:0444\:0435\
\:0440\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:044b\:0435 \:0443\
\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f \:0434\:043b\:044f f13, f23. \
\:0414\:043b\:044f \:044d\:0442\:043e\:0433\:043e \:0443\:043f\:0440\:043e\
\:0441\:0442\:0438\:043c \:0432\:044b\:0440\:0430\:0436\:0435\:043d\:0438\
\:0435 \:0432\:044b\:0448\:0435.\
\>", "Text",
 CellChangeTimes->{{3.7502578540451803`*^9, 3.7502578944520903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsml", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"vars2", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2", ",", "4"}], "}"}]}], "]"}], "//", 
      "Simplify"}], "//", "PowerExpand"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"varsml", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.7502577984856052`*^9, 3.750257820911661*^9}, {
   3.75025790127687*^9, 3.7502579229539056`*^9}, 3.750321031189638*^9, 
   3.7503211673392696`*^9, {3.750321514532762*^9, 3.750321515662922*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
       RowBox[{"Cos", "[", "u", "]"}], " ", 
       RowBox[{"Sin", "[", "u", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
          RowBox[{"f13", "[", "r", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f23", "[", "r", "]"}], "-", 
            RowBox[{"r", " ", 
             RowBox[{
              SuperscriptBox["f23", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}], 
        ")"}]}], 
      SuperscriptBox["r", "2"]], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "u", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", 
           SuperscriptBox["\[Omega]", "2"], " ", 
           RowBox[{"f23", "[", "r", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["f13", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{
            SuperscriptBox["f23", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
       SuperscriptBox["r", "2"]]}]},
    {
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"5", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "u", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"10", "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
          RowBox[{"f13", "[", "r", "]"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f23", "[", "r", "]"}], "-", 
            RowBox[{"r", " ", 
             RowBox[{
              SuperscriptBox["f23", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "2"]}]], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"15", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
        RowBox[{"Cos", "[", "u", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "u", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", 
           SuperscriptBox["\[Omega]", "2"], " ", 
           RowBox[{"f23", "[", "r", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["f13", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{
            SuperscriptBox["f23", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
       SuperscriptBox["r", "2"]]}]},
    {
     FractionBox[
      RowBox[{"5", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
       RowBox[{"Cos", "[", "u", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"7", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "u", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"18", "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
          RowBox[{"f13", "[", "r", "]"}]}], "+", 
         RowBox[{"18", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f23", "[", "r", "]"}], "-", 
            RowBox[{"r", " ", 
             RowBox[{
              SuperscriptBox["f23", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "2"]}]], 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"15", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ct", " ", "\[Omega]"}]], " ", 
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{"7", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "u", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", 
           SuperscriptBox["\[Omega]", "2"], " ", 
           RowBox[{"f23", "[", "r", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["f13", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{
            SuperscriptBox["f23", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["r", "2"]}]]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7502578215300083`*^9, {3.7502579154898787`*^9, 3.7502579232989836`*^9}, {
   3.750320997939225*^9, 3.750321031953339*^9}, 3.750321168557313*^9, 
   3.75032151589532*^9}]
}, Open  ]],

Cell["\:041e\:043f\:0440\:0435\:0434\:0435\:043b\:0438\:043c \:043e\:0431\
\:0449\:0438\:0439 \:0432\:0438\:0434 \:043a\:043e\:044d\:0444\:0444\:0438\
\:0446\:0438\:0435\:043d\:0442\:043e\:0432 \:0432 \:0432\:044b\:0440\:0430\
\:0436\:0435\:043d\:0438\:0438.", "Text",
 CellChangeTimes->{{3.75032153160686*^9, 3.7503215675591354`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"l2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Fit", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "18"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "l", ",", 
          SuperscriptBox["l", "2"]}], "}"}], ",", "l"}], "]"}], "//", 
      "Chop"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{"x_Real", "\[RuleDelayed]", 
      RowBox[{"Round", "[", "x", "]"}]}], "}"}]}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.7503210470972013`*^9, 3.750321133850951*^9}, {
  3.750321173261525*^9, 3.750321175635047*^9}, {3.7503212778097486`*^9, 
  3.7503213358280845`*^9}, {3.750321367183514*^9, 3.7503213807467194`*^9}, {
  3.7503214199443927`*^9, 3.750321509483635*^9}, {3.750321573215131*^9, 
  3.7503216176839247`*^9}, {3.75032195990038*^9, 3.7503219599313045`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", "l"}], ")"}]}]], "Output",
 CellChangeTimes->{{3.750321317700074*^9, 3.7503213361329064`*^9}, 
   3.750321381259181*^9, 3.7503214228830314`*^9, {3.7503214548723426`*^9, 
   3.7503215099020505`*^9}, {3.7503215749021416`*^9, 3.7503216190721893`*^9}, 
   3.7503219814390383`*^9}]
}, Open  ]],

Cell["\<\
\:0412\:0438\:0434\:043d\:043e, \:0447\:0442\:043e \:043f\:0435\:0440\:0435\
\:043c\:0435\:043d\:043d\:044b\:0435 \:0440\:0430\:0437\:0434\:0435\:043b\
\:044f\:044e\:0442\:0441\:044f \:0438 \:0434\:0438\:0444\:0444\:0435\:0440\
\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:044b\:0435 \:0443\:0440\
\:0430\:0432\:043d\:0435\:043d\:0438\:044f \:043f\:043e\:043b\:0443\:0447\
\:0430\:044e\:0442\:0441\:044f \:043b\:0435\:0433\:043a\:043e.\
\>", "Text",
 CellChangeTimes->{{3.750257933189546*^9, 3.750257962208006*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"df1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l2", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
     RowBox[{"f13", "[", "r", "]"}]}], "+", 
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f23", "[", "r", "]"}], "-", 
       RowBox[{"r", " ", 
        RowBox[{
         SuperscriptBox["f23", "\[Prime]",
          MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"df2", "=", 
   RowBox[{
    RowBox[{"r", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"f23", "[", "r", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["f13", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}], "-", 
    RowBox[{"r", " ", 
     RowBox[{
      SuperscriptBox["f23", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.750321949915915*^9, {3.7503219834026403`*^9, 3.7503220176215734`*^9}, {
   3.7503233963245*^9, 3.750323399627386*^9}}],

Cell["\:0418\:0441\:043a\:043b\:044e\:0447\:0438\:043c f13 \:0438 \
\:043f\:043e\:043b\:0443\:0447\:0438\:043c \:0434\:0438\:0444\:0444\:0435\
\:0440\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:043e\:0435 \:0443\
\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0435 \:043d\:0430 f23.", "Text",
 CellChangeTimes->{{3.750323426747348*^9, 3.750323442204918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"df3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"df2", "/.", 
      RowBox[{"f13", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f13", "[", "r", "]"}], "/.", 
             RowBox[{"First", "@", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"df1", "\[Equal]", "0"}], ",", 
                RowBox[{"f13", "[", "r", "]"}]}], "]"}]}]}], ")"}], "/.", 
           RowBox[{"r", "\[Rule]", "#"}]}], ")"}], "&"}], ")"}]}]}], "//", 
     "Together"}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"df3", "=", 
   RowBox[{
    RowBox[{"df3", "/", "r"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l2", "\[Rule]", "L2"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l2", "//", "Expand"}], ")"}], "\[Rule]", "L2"}], ",", 
      RowBox[{
       RowBox[{"l", 
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}]}], "\[Rule]", 
       RowBox[{"2", "L1"}]}], ",", 
      RowBox[{"\[Omega]", "\[Rule]", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"df3", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"df3", "\[Equal]", "0"}], "//", "FullSimplify"}], ")"}], "/.", 
   RowBox[{"Equal", "\[Rule]", "Subtract"}]}]}]}], "Input",
 CellChangeTimes->{{3.750322034247252*^9, 3.7503220807438297`*^9}, {
  3.7503221277216864`*^9, 3.7503222190411186`*^9}, {3.7503225740763283`*^9, 
  3.7503226162377405`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "L1", " ", "L2"}], "+", 
       RowBox[{"2", " ", "L2", " ", 
        SuperscriptBox["r", "2"]}], "+", 
       SuperscriptBox["r", "4"]}], ")"}], " ", 
     RowBox[{"f23", "[", "r", "]"}]}], "-", 
    RowBox[{"2", " ", "L2", " ", "r", " ", 
     RowBox[{
      SuperscriptBox["f23", "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}]}], 
   RowBox[{"L2", "+", 
    SuperscriptBox["r", "2"]}]], "-", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{
    SuperscriptBox["f23", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "r", "]"}]}]}]], "Output",
 CellChangeTimes->{3.750322622389076*^9, 3.750323413406105*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1584, 1117},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.9 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 112, 1, 118, "Section"],
Cell[CellGroupData[{
Cell[717, 27, 1233, 32, 228, "Input"],
Cell[1953, 61, 456, 9, 45, "Message"]
}, Open  ]],
Cell[2424, 73, 590, 12, 57, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3051, 90, 224, 2, 88, "Section"],
Cell[CellGroupData[{
Cell[3300, 96, 451, 6, 81, "Subsection"],
Cell[3754, 104, 48, 1, 57, "Input"],
Cell[3805, 107, 197, 4, 57, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[4039, 116, 534, 7, 62, "Subsection"],
Cell[4576, 125, 1037, 32, 160, "Input"],
Cell[5616, 159, 2525, 68, 562, "Input"],
Cell[8144, 229, 720, 22, 90, "Input"],
Cell[8867, 253, 1552, 47, 132, "Input"],
Cell[10422, 302, 452, 13, 57, "Input"],
Cell[10877, 317, 497, 11, 57, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[11411, 333, 698, 9, 62, "Subsection"],
Cell[12112, 344, 271, 3, 58, "Text"],
Cell[CellGroupData[{
Cell[12408, 351, 682, 18, 154, "Input"],
Cell[13093, 371, 5442, 139, 411, "Output"]
}, Open  ]],
Cell[18550, 513, 419, 12, 57, "Input"],
Cell[18972, 527, 507, 8, 58, "Text"],
Cell[CellGroupData[{
Cell[19504, 539, 602, 15, 177, "Input"],
Cell[20109, 556, 6526, 180, 237, "Output"]
}, Open  ]],
Cell[26650, 739, 335, 4, 58, "Text"],
Cell[CellGroupData[{
Cell[27010, 747, 1075, 28, 113, "Input"],
Cell[28088, 777, 414, 10, 80, "Output"]
}, Open  ]],
Cell[28517, 790, 530, 8, 58, "Text"],
Cell[29050, 800, 1135, 35, 122, "Input"],
Cell[30188, 837, 360, 4, 58, "Text"],
Cell[CellGroupData[{
Cell[30573, 845, 1573, 46, 245, "Input"],
Cell[32149, 893, 765, 23, 112, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

